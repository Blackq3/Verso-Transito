<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tr√°nsito Verso</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
</head>
<body class="bg-gray-100 text-gray-800">

  <!-- HEADER -->
  <header class="bg-white shadow-md p-4 flex items-center justify-between">
    <div class="flex items-center space-x-4">
      <img src="https://i.imgur.com/JI7EkFp.png" alt="Logo Tr√°nsito Verso" class="h-12">
      <h1 class="text-xl font-bold text-green-600">Tr√°nsito Verso</h1>
    </div>
    <div class="space-x-2">
      <button class="bg-white border border-gray-300 px-4 py-2 rounded hover:bg-gray-100">Ingresar</button>
      <button class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Crear cuenta</button>
    </div>
  </header>

  <!-- MAIN CONTENT -->
  <main class="max-w-6xl mx-auto px-4 py-8">

    <!-- T√çTULO Y BUSCADOR -->
    <div class="text-center mb-8">
      <h2 class="text-3xl font-bold text-purple-700">Movilidad en L√≠nea</h2>
      <p class="text-gray-600 mt-2">Consulta aqu√≠ tus fotodetecciones, multas y acuerdos de pago</p>

      <div class="mt-6 flex justify-center">
        <input id="searchInput" type="text" placeholder="Ingresa la placa del veh√≠culo" class="w-full max-w-xl px-4 py-2 border rounded-l-md">
        <button onclick="buscarMulta()" class="bg-green-500 px-4 rounded-r-md text-white hover:bg-green-600">üîç</button>
      </div>
    </div>

    <!-- TARJETAS -->
    <div class="grid md:grid-cols-3 gap-6 mb-12">
      <div class="bg-white rounded-xl p-6 shadow hover:shadow-md">
        <h3 class="text-purple-700 font-semibold text-lg mb-2">Consultar</h3>
        <p class="text-sm text-gray-600 mb-4">El estado del veh√≠culo</p>
        <button class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Consultar estado</button>
      </div>
      <div class="bg-white rounded-xl p-6 shadow hover:shadow-md">
        <h3 class="text-purple-700 font-semibold text-lg mb-2">Exentos</h3>
        <p class="text-sm text-gray-600 mb-4">Pico y placa</p>
        <button class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Consultar exentos</button>
      </div>
      <div class="bg-white rounded-xl p-6 shadow hover:shadow-md">
        <h3 class="text-purple-700 font-semibold text-lg mb-2">Solicita aqu√≠</h3>
        <p class="text-sm text-gray-600 mb-4">Citas para tu tr√°mite</p>
        <button class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">Solicitar cita</button>
      </div>
    </div>

    <!-- RESULTADO DE B√öSQUEDA -->
    <div id="resultado" class="hidden bg-white p-4 rounded shadow mb-6"></div>

    <!-- BOT√ìN DE TRABAJADOR -->
    <div class="flex justify-end mb-4">
      <button onclick="mostrarFormularioTrabajador()" class="text-white bg-gray-700 hover:bg-gray-800 p-2 rounded-full">
        üë∑
      </button>
    </div>

    <!-- FORMULARIO PARA TRABAJADORES -->
    <div id="formularioTrabajador" class="hidden bg-white p-6 rounded shadow-md space-y-4">
      <input type="password" id="claveTrabajador" placeholder="Ingrese clave de trabajador" class="border px-4 py-2 rounded w-full">
      <div id="contenidoTrabajador" class="hidden space-y-4">
        <input type="text" id="matricula" placeholder="Matr√≠cula" class="border px-4 py-2 rounded w-full">
        <input type="text" id="valor" placeholder="Valor de la multa" class="border px-4 py-2 rounded w-full">
        <input type="text" id="razon" placeholder="Raz√≥n de la multa" class="border px-4 py-2 rounded w-full">
        <input type="file" id="imagen" class="w-full">
        <button onclick="subirMulta()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Subir multa</button>
      </div>
    </div>

  </main>

  <!-- FOOTER -->
  <footer class="bg-white p-4 border-t text-center text-sm text-gray-500">
    ¬© 2025 Tr√°nsito Verso ‚Äî Todos los derechos reservados
  </footer>

  <!-- FIREBASE CONFIG & L√ìGICA -->
  <script>
    const firebaseConfig = {
      projectId: "transito-verso-517a0",
      authDomain: "transito-verso-517a0.firebaseapp.com",
      storageBucket: "transito-verso-517a0.appspot.com",
      appId: "1:1055859388199:web:ee4da62ab82663ef414302"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    const storage = firebase.storage();

    function mostrarFormularioTrabajador() {
      const clave = prompt("Ingrese la clave de trabajador:");
      if (clave === "verso11") {
        document.getElementById("formularioTrabajador").classList.remove("hidden");
        document.getElementById("contenidoTrabajador").classList.remove("hidden");
      } else {
        alert("Clave incorrecta.");
      }
    }

    async function subirMulta() {
      const matricula = document.getElementById("matricula").value;
      const valor = document.getElementById("valor").value;
      const razon = document.getElementById("razon").value;
      const imagen = document.getElementById("imagen").files[0];

      if (!matricula || !valor || !razon || !imagen) {
        alert("Por favor llena todos los campos.");
        return;
      }

      const ref = storage.ref().child(`multas/${matricula}-${Date.now()}`);
      await ref.put(imagen);
      const url = await ref.getDownloadURL();

      await db.collection("multas").doc(matricula).set({
        valor,
        razon,
        imagen: url
      });

      alert("Multa subida correctamente.");
    }

    async function buscarMulta() {
      const placa = document.getElementById("searchInput").value;
      const doc = await db.collection("multas").doc(placa).get();
      const resultado = document.getElementById("resultado");
      if (doc.exists) {
        const datos = doc.data();
        resultado.innerHTML = `
          <h3 class="font-bold text-lg mb-2">Multa para placa: ${placa}</h3>
          <img src="${datos.imagen}" alt="Imagen multa" class="h-48 mb-2">
          <p><strong>Valor:</strong> ${datos.valor}</p>
          <p><strong>Raz√≥n:</strong> ${datos.razon}</p>
        `;
      } else {
        resultado.innerHTML = `<p>No se encontr√≥ multa para esta placa.</p>`;
      }
      resultado.classList.remove("hidden");
    }
  </script>
</body>
</html>

